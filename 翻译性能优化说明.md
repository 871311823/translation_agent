# 翻译性能优化说明

## 优化内容

### 1. 超时控制优化
- **动态超时设置**: 根据文件大小自动调整超时时间
  - 小文件(<1000字符): 2分钟超时
  - 中等文件(1000-5000字符): 5分钟超时  
  - 大文件(>5000字符): 10分钟超时
- **API请求超时**: 根据提示长度动态调整(60-180秒)
- **任务级超时**: 防止单个任务无限等待

### 2. 并发处理优化
- **智能任务队列**: 改进的任务管理，避免死锁
- **实时状态监控**: 更好的进度反馈和错误处理
- **优雅停止机制**: 支持暂停/继续/停止操作

### 3. 性能模式设置
新增三种性能模式，用户可根据需求选择：

#### 快速模式
- API超时: 60秒
- 并发任务: 8个
- 请求频率: 100 RPM
- 重试次数: 1次
- **适用**: 小文件批量翻译

#### 平衡模式 (默认)
- API超时: 120秒
- 并发任务: 5个
- 请求频率: 60 RPM
- 重试次数: 2次
- **适用**: 大多数情况

#### 稳定模式
- API超时: 300秒
- 并发任务: 3个
- 请求频率: 30 RPM
- 重试次数: 3次
- **适用**: 大文件或网络不稳定环境

### 4. 错误处理增强
- **详细错误分类**: 超时、网络、API错误等
- **自动重试机制**: 可配置重试次数
- **错误恢复**: 失败任务不影响其他任务

### 5. 资源管理优化
- **内存使用优化**: 避免大文件内存占用过多
- **线程池管理**: 更好的并发控制
- **连接复用**: 减少API连接开销

## 使用建议

### 网络环境良好
- 选择"快速模式"
- 并发数可设置为8-10
- 适合批量处理小文件

### 网络环境一般
- 选择"平衡模式"(默认)
- 并发数保持5左右
- 适合大多数使用场景

### 网络环境较差或大文件
- 选择"稳定模式"
- 并发数降低到2-3
- 增加超时时间和重试次数

### 文件大小建议
- **小文件** (<2KB): 快速模式，高并发
- **中等文件** (2-10KB): 平衡模式，中等并发
- **大文件** (>10KB): 稳定模式，低并发

## 故障排除

### 翻译卡住不动
1. 检查网络连接
2. 降低并发任务数
3. 增加超时时间
4. 切换到稳定模式

### 频繁超时错误
1. 增加API超时设置
2. 降低请求频率(RPM)
3. 检查API服务器状态
4. 尝试切换API端点

### 内存占用过高
1. 降低并发任务数
2. 分批处理大文件
3. 关闭其他占用内存的程序

## 性能监控

软件提供实时性能监控：
- 任务完成率
- 平均处理时间
- 错误统计
- 资源使用情况

通过"翻译进度"页面可以查看详细的性能数据和任务状态。

## 更新日志

### v2.1.0 性能优化版本
- ✅ 添加动态超时控制
- ✅ 优化并发处理逻辑
- ✅ 新增性能模式选择
- ✅ 增强错误处理机制
- ✅ 改进资源管理
- ✅ 添加实时性能监控

这些优化显著提升了翻译效率和稳定性，特别是在处理大批量文件时的表现。