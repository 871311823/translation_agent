# 服务器服务检查指南

## 连接服务器

```bash
ssh root@47.109.82.94
# 或使用你的用户名
ssh your_username@47.109.82.94
```

## 检查命令

### 1. 查看所有运行中的服务
```bash
systemctl list-units --type=service --state=running --no-pager
```

### 2. 查看所有已启用的服务（开机自启动）
```bash
systemctl list-unit-files --type=service --state=enabled --no-pager
```

### 3. 查看监听端口的服务
```bash
# CentOS/RHEL
netstat -tlnp

# Ubuntu/Debian
ss -tlnp
```

### 4. 查看系统资源使用
```bash
# 磁盘使用
df -h

# 内存使用
free -h

# CPU和内存占用最高的进程
ps aux --sort=-%mem | head -20
```

## 常见不必要的服务（根据服务器用途选择关闭）

### 通常可以关闭的服务：

1. **邮件服务**（如果不是邮件服务器）
   - `postfix` - 邮件传输代理
   - `sendmail` - 邮件服务器
   - `dovecot` - IMAP/POP3 服务器

2. **打印服务**（服务器通常不需要）
   - `cups` - 打印服务
   - `cups-browsed` - 打印机发现服务

3. **桌面环境服务**（如果是纯服务器）
   - `gdm` - GNOME 显示管理器
   - `lightdm` - 轻量级显示管理器
   - `accounts-daemon` - 用户账户服务

4. **蓝牙服务**（服务器通常不需要）
   - `bluetooth` - 蓝牙服务

5. **其他可能不必要的服务**
   - `avahi-daemon` - 本地网络服务发现（mDNS）
   - `ModemManager` - 调制解调器管理
   - `NetworkManager-wait-online` - 如果使用静态IP可能不需要
   - `snapd` - 如果不用Snap包
   - `unattended-upgrades` - 自动更新（根据需求）

### 检查服务状态
```bash
systemctl status <服务名>
```

### 停止服务
```bash
systemctl stop <服务名>
```

### 禁用服务（防止开机自启）
```bash
systemctl disable <服务名>
```

### 同时停止并禁用
```bash
systemctl stop <服务名>
systemctl disable <服务名>
```

## 安全建议

1. **先检查服务用途**：不确定的服务先查文档
2. **不要关闭关键服务**：
   - `sshd` - SSH服务（关闭后无法远程连接）
   - `network` / `NetworkManager` - 网络服务
   - `systemd-*` - 系统核心服务
   - `dbus` - 系统消息总线
3. **备份重要数据**：操作前建议备份
4. **测试环境先试**：如果有测试环境，先在测试环境验证

## 生成服务报告

运行以下命令生成详细报告：
```bash
systemctl list-units --type=service --state=running --no-pager > running_services.txt
systemctl list-unit-files --type=service --state=enabled --no-pager > enabled_services.txt
netstat -tlnp > listening_ports.txt
```


