# 📚 小说翻译快速指南

## 🎯 适合小说网站的翻译输出

你的翻译软件现在已经优化，输出的内容完全适合直接上传到小说网站！

## ✨ 新功能特点

### 1. 纯净输出
- ✅ **无AI痕迹**：自动移除"翻译如下："、"Translation:"等AI标记
- ✅ **直接可用**：输出内容直接从正文开始
- ✅ **格式优化**：段落间距合理，适合阅读

### 2. 智能文件命名
- 📝 **章节名优先**：如果内容包含章节标题（如"Chapter 1"），自动用作文件名
- 🔤 **文件名翻译**：如果是中文文件名，自动翻译成英文
- 💾 **清晰命名**：文件名清晰易识别

### 3. 格式清理
- 🧹 **移除多余空行**：压缩3个以上的连续空行
- 📏 **统一格式**：段落间保持1-2个空行
- ✂️ **去除空格**：自动清理行尾多余空格

## 🚀 使用方法

### 桌面版（translation_agent_gui.py）

1. **启动软件**
   ```bash
   python translation_agent_gui.py
   ```
   或双击：
   ```bash
   启动翻译软件.bat
   ```

2. **配置API**（首次使用）
   - 进入"🔧 API设置"标签页
   - 选择API端点（OpenAI/Groq等）
   - 输入API密钥
   - 点击"🔍 测试API连接"

3. **翻译文件**
   - 进入"📁 文件管理"标签页
   - 选择输入文件夹
   - 选择文件类型（txt, md, pdf, docx等）
   - 点击"🔍 扫描文件"
   - 选择输出格式（txt或docx）
   - 点击"🚀 开始翻译"

4. **获取结果**
   - 翻译完成后，文件自动保存到输出文件夹
   - 默认位置：桌面/translations
   - 文件名：自动使用章节名或翻译后的文件名

### 网页版（app/app.py）

1. **启动服务**
   ```bash
   python app/app.py
   ```

2. **打开浏览器**
   - 访问：http://localhost:7860

3. **上传翻译**
   - 上传文本文件或直接粘贴内容
   - 配置翻译参数
   - 点击"开始翻译"
   - 下载翻译结果

## 📋 输出示例

### 输入文件：第一章.txt
```
第一章：黑暗之夜

那是一个风雨交加的夜晚。风在树林中呼啸。

约翰望着窗外，不知道接下来会发生什么。
```

### 输出文件：Chapter 1 The Dark Night.txt
```
Chapter 1: The Dark Night

It was a dark and stormy night. The wind howled through the trees.

John looked out the window, wondering what would happen next.
```

**注意**：
- ✅ 没有"翻译如下："等标记
- ✅ 直接从章节标题开始
- ✅ 段落格式清晰
- ✅ 文件名使用章节标题

## 🎨 输出格式选择

### TXT格式（推荐）
- ✅ 兼容性最好
- ✅ 文件小，加载快
- ✅ 适合大多数小说网站
- ✅ 可以直接复制粘贴

### DOCX格式
- ✅ 保留格式
- ✅ 适合进一步编辑
- ✅ 可以添加样式
- ⚠️ 需要安装python-docx库

## 💡 使用技巧

### 1. 批量翻译小说章节
```
输入文件夹结构：
novels/
  ├── 第一章.txt
  ├── 第二章.txt
  ├── 第三章.txt
  └── ...

输出文件夹结构：
translations/
  ├── Chapter 1 The Beginning.txt
  ├── Chapter 2 The Journey.txt
  ├── Chapter 3 The Battle.txt
  └── ...
```

### 2. 章节标题格式建议
为了让软件正确识别章节标题，建议使用以下格式：
- ✅ "第一章：标题"
- ✅ "Chapter 1: Title"
- ✅ "Prologue"
- ✅ "Epilogue"

### 3. 文件命名建议
- 使用清晰的章节编号
- 避免特殊字符（: / \ * ? " < > |）
- 保持文件名简短（<100字符）

## ⚙️ 高级设置

### 翻译参数优化
- **温度（Temperature）**：0.3（推荐）- 更准确
- **最大Token数**：1000-2000 - 根据章节长度调整
- **并发任务数**：3-5 - 根据API限制调整

### 性能模式
- **快速模式**：适合短文本，速度快
- **平衡模式**：适合大多数情况（推荐）
- **稳定模式**：适合长文本，更可靠

### API超时设置
- 小文件（<5000字）：180秒
- 中等文件（5000-10000字）：300秒
- 大文件（>10000字）：600秒

## 🔍 质量检查

翻译完成后，建议检查：
1. ✅ 章节标题是否正确
2. ✅ 段落格式是否清晰
3. ✅ 没有AI标记残留
4. ✅ 人名、地名翻译一致
5. ✅ 对话格式正确

## 📤 上传到小说网站

### 准备工作
1. 检查翻译质量
2. 确认格式正确
3. 准备章节列表

### 上传步骤
1. 登录小说网站
2. 创建新作品或选择现有作品
3. 添加新章节
4. 复制粘贴翻译内容或上传文件
5. 预览检查
6. 发布

### 常见问题
- **Q: 段落格式不对？**
  - A: 使用TXT格式，大多数网站会自动处理段落

- **Q: 章节标题重复？**
  - A: 网站通常有单独的标题输入框，可以删除正文中的标题

- **Q: 特殊字符显示异常？**
  - A: 确保使用UTF-8编码保存文件

## 🎉 完成！

现在你可以：
- ✅ 批量翻译小说章节
- ✅ 获得适合网站的格式
- ✅ 直接上传，无需编辑
- ✅ 享受高质量的翻译结果

祝你的小说翻译项目顺利！📚✨

---

## 📞 技术支持

如有问题，请查看：
- 📖 详细说明：`小说翻译格式优化说明.md`
- 🧪 测试脚本：`test_format_cleaning.py`
- 📝 其他文档：`桌面版使用说明.md`
