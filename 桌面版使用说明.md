# Translation Agent Pro - 桌面版使用说明

## 🚀 软件简介

**Translation Agent Pro 桌面版** 是一款专业的批量翻译桌面应用程序，采用 tkinter 构建的原生 GUI 界面，提供完整的可视化翻译工作流管理功能。

### ✨ 核心特性

- 🖥️ **原生桌面界面**: 基于 tkinter 的真正桌面应用程序
- 🔧 **API配置管理**: 支持多种LLM提供商，内置连接测试功能
- 📁 **智能文件管理**: 可视化文件夹扫描，支持多种文件格式
- 🚀 **并发翻译处理**: 最大10个文件同时翻译，可调节并发数
- 📊 **实时进度监控**: 表格化进度显示，实时显示翻译状态
- 💾 **自动结果保存**: 智能命名，自动保存到指定文件夹
- 🎯 **反思式翻译**: 三阶段翻译流程，确保翻译质量

## 🚀 快速开始

### 系统要求

- **操作系统**: Windows 7+, macOS 10.12+, Linux
- **Python版本**: 3.9 或更高版本
- **依赖库**: tkinter (通常随 Python 安装)

### 安装依赖

在首次使用前，请安装必要的依赖包：

```bash
# 安装所有依赖
pip install -r requirements.txt

# 或者单独安装核心依赖
pip install openai tiktoken python-dotenv langchain-text-splitters icecream python-docx PyMuPDF simplemma
```

### 启动方式

**Windows 用户（推荐）：**
```bash
# 双击运行
启动翻译软件.bat
```

**跨平台启动：**
```bash
python 启动翻译软件.py
```

**直接启动：**
```bash
python translation_agent_gui.py
```

## 📖 详细使用指南

### 1. 🔧 API设置页面

桌面应用的第一个标签页，用于配置翻译API。

#### 主要API配置

1. **API端点选择**
   - 下拉菜单选择：OpenAI、Groq、TogetherAI、Ollama、CUSTOM
   - 选择不同端点会自动更新默认模型名称

2. **模型配置**
   - **模型名称**: 可编辑文本框，支持自定义模型名
   - **API密钥**: 密码输入框，确保安全性
   - **基础URL**: 仅在选择 CUSTOM 端点时显示

3. **额外端点配置**
   - 勾选"启用额外端点"显示额外配置区域
   - 用于反思步骤的独立API配置
   - 可以使用不同的API提供商进行反思

#### 翻译参数

- **源语言**: 待翻译文本的语言
- **目标语言**: 翻译目标语言  
- **地区**: 指定语言的地区变体

#### 高级参数

- **最大Token数**: 滑动条调节 (512-4096)
- **温度**: 滑动条调节 (0.0-1.0)
- **每分钟请求数**: 滑动条调节 (1-1000)

#### 操作按钮

- **🔍 测试API连接**: 验证API配置是否正确
- **💾 保存配置**: 保存当前所有设置到本地文件

### 2. 📁 文件管理页面

管理输入文件和输出设置的可视化界面。

#### 输入文件设置

1. **输入文件夹选择**
   - 文本框显示当前选择的文件夹路径
   - "浏览"按钮打开文件夹选择对话框

2. **文件类型选择**
   - 复选框组：txt, md, pdf, docx, py, json, cpp
   - 可以选择多种文件类型同时处理

3. **文件扫描**
   - 点击"🔍 扫描文件"按钮
   - 在表格中显示找到的所有匹配文件
   - 显示文件名、大小、类型信息

#### 输出文件设置

1. **输出文件夹选择**
   - 默认路径：`~/Desktop/translations`
   - "浏览"按钮选择自定义输出位置

2. **并发任务数设置**
   - 滑动条调节同时处理的文件数量 (1-10)
   - 实时显示当前设置值

#### 文件列表显示

- **表格视图**: 清晰显示所有待翻译文件
- **列信息**: 文件名、大小、类型
- **滚动支持**: 处理大量文件时的界面滚动

#### 操作按钮

- **🚀 开始批量翻译**: 启动翻译任务
- **🗑️ 清空任务**: 清除所有翻译任务

### 3. 📊 翻译进度页面

实时监控翻译任务执行状态的可视化界面。

#### 总体进度显示

- **进度文本**: 显示"已完成/总数"和百分比
- **进度条**: 可视化总体翻译进度
- **实时更新**: 每2秒自动刷新

#### 详细进度表格

表格列信息：
- **文件名**: 当前处理的文件名
- **状态**: 等待中、翻译中、已完成、失败
- **进度**: 百分比进度显示
- **耗时**: 翻译所用时间
- **错误信息**: 失败任务的具体错误

#### 状态说明

- 🟡 **等待中**: 任务已创建，等待执行
- 🔵 **翻译中**: 正在执行翻译
- 🟢 **已完成**: 翻译完成并保存
- 🔴 **失败**: 翻译过程中出现错误

#### 操作按钮

- **🔄 刷新进度**: 手动刷新进度显示
- **📁 打开输出文件夹**: 直接打开结果文件夹

### 4. ℹ️ 关于页面

显示软件信息、功能介绍和使用帮助的滚动文本区域。

## 📁 输出文件格式

翻译完成的文件保存为 `.txt` 格式，命名规则：`原文件名_translated.txt`

### 文件内容结构

```
原文件名: 技术文档
翻译时间: 2024-12-22 15:30:15
==================================================

最终翻译结果:
[经过反思优化的最终翻译内容]

==================================================

初始翻译:
[第一次翻译的结果]

------------------------------

反思建议:
[LLM对初始翻译的改进建议]
```

## ⚙️ 高级功能

### 配置文件管理

- **自动保存**: 程序关闭时自动保存配置
- **自动加载**: 程序启动时自动加载上次配置
- **配置文件**: `translation_config.json`

### 多线程处理

- **后台翻译**: 翻译任务在后台线程执行，不阻塞界面
- **并发控制**: 使用线程池管理并发任务
- **实时更新**: 翻译状态实时反馈到界面

### 错误处理

- **API连接测试**: 启动翻译前验证API配置
- **文件读取错误**: 自动跳过无法读取的文件
- **翻译失败处理**: 显示具体错误信息，不影响其他任务

## 🔧 故障排查

### 启动问题

**问题**: 软件无法启动
**解决方案**:
```bash
# 检查Python版本
python --version  # 需要3.9+

# 检查tkinter是否可用
python -c "import tkinter; print('tkinter可用')"

# 检查依赖文件
ls app/process.py app/patch.py src/translation_agent/utils.py
```

### API连接问题

**问题**: API测试失败
**解决方案**:
- 点击"🔍 测试API连接"查看具体错误
- 检查API密钥是否正确
- 确认网络连接正常
- 验证基础URL格式（CUSTOM端点）

### 文件处理问题

**问题**: 文件扫描失败或翻译失败
**解决方案**:
- 确保输入文件夹路径正确
- 检查文件权限和格式
- 查看进度页面的错误信息
- 确认选择了正确的文件类型

### 界面问题

**问题**: 界面显示异常
**解决方案**:
- 调整窗口大小 (最小1000x700)
- 检查系统DPI设置
- 重启应用程序

## 📊 性能优化建议

### 1. 并发数量设置

根据以下因素调整并发数：
- **小文件** (<1000字): 8-10个并发
- **中等文件** (1000-5000字): 5个并发
- **大文件** (>5000字): 2-3个并发
- **API限制**: 注意RPM限制

### 2. 文件预处理

- **清理格式**: 删除不必要的格式标记
- **分割大文件**: 超大文件建议手动分割
- **统一编码**: 确保文件编码为UTF-8

### 3. 系统资源

- **内存使用**: 大量文件时注意内存占用
- **磁盘空间**: 确保输出文件夹有足够空间
- **网络稳定**: 保持稳定的网络连接

## 🔄 版本信息

### 当前版本: v2.0.0

**主要特性:**
- 原生桌面GUI界面
- 完整的可视化工作流
- 实时进度监控
- 自动配置管理
- 多线程并发处理

### 技术架构

- **GUI框架**: tkinter (Python标准库)
- **多线程**: ThreadPoolExecutor
- **配置管理**: JSON格式本地存储
- **文件处理**: 支持PDF、DOCX、文本文件
- **翻译引擎**: 反思式三阶段工作流

## 📞 技术支持

### 常见问题

1. **Q: 支持哪些操作系统？**
   A: Windows、macOS、Linux (需要Python 3.9+)

2. **Q: 需要安装额外的依赖吗？**
   A: 主要依赖tkinter，通常随Python安装

3. **Q: 配置文件保存在哪里？**
   A: 程序目录下的 `translation_config.json`

4. **Q: 如何备份配置？**
   A: 复制 `translation_config.json` 文件即可

### 获取帮助

如果遇到问题：
1. 查看软件内的"关于"页面
2. 检查控制台错误信息
3. 确认所有依赖文件完整
4. 提交Issue到GitHub仓库

---

**享受专业的桌面翻译体验！** 🎉